{"version":3,"sources":["next-ajax-promise.js"],"names":[],"mappings":";;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"next-ajax-promise.js","sourcesContent":["(function() {\n  var global = global || this || window || Function('return this')();\n  var nx = global.nx || require('next-js-core2');\n  var NxAjax = nx.Ajax || require('next-ajax');\n  var CANCELED_MAP = {};\n  var DEFAULT_OPTIONS = { cancelable: false };\n\n  var NxAjaxPromise = nx.declare('nx.AjaxPromise', {\n    statics: {\n      CANCELED_MAP: CANCELED_MAP,\n      fetch: function(inMethod, inUrl, inData, inOptions) {\n        var instance = new NxAjaxPromise(inMethod, inUrl, inData, inOptions);\n        return new Promise(function(resolve, reject) {\n          instance.ajax.fetch({\n            onSuccess: function(res) {\n              resolve(res);\n            },\n            onFail: function(res) {\n              reject(res);\n            },\n            onTimeout: function(res) {\n              reject(res);\n            },\n            onComplete: function(res) {\n              resolve(res);\n            }\n          });\n        });\n      }\n    },\n    methods: {\n      init: function(inMethod, inUrl, inData, inOptions) {\n        var self = this;\n        var options = nx.mix(null, DEFAULT_OPTIONS, inOptions);\n        var id = this.__id__;\n        this.ajax = new NxAjax(inMethod, inUrl, inData, inOptions);\n\n        if (options.cancelable) {\n          CANCELED_MAP[id] = function() {\n            self.ajax.destroy();\n          };\n          // lazy execute?:\n          Promise.prototype.destroy = function() {\n            (CANCELED_MAP[id] || nx.noop)();\n          };\n        }\n      }\n    }\n  });\n\n  if (typeof module !== 'undefined' && module.exports) {\n    module.exports = NxAjaxPromise;\n  }\n})();\n"]}